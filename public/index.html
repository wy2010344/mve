<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
<meta name="apple-mobile-web-app-capable" content="yes" /> <!-- safari强制全屏 -->
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>首页</title>
<style type="text/css">
html,body,#root{
    margin: 0;
    border:none;
    padding: 0;
    overflow: hidden;
}
html,body{
    width:100%;
    height: 100%;
    position: fixed;
}
</style>
<script type="text/javascript" src="./lib/lib.js"></script>
<script type="text/javascript">
window.onload=function(){
    var cp={
            libUrl:function(){
                return "./lib/";
            },
            topUrl:function(){
                return "./";
            },
            baseUrl:function(){
                return "./index/";
            }
    };
    mb.ajax.require.baseUrl=cp.baseUrl();
    mb.ajax.require.cp=cp;
    var query=mb.util.dicFromUrl(window.location.search);
    /*
    if(window.addEventListener){
        //禁止iOS的橡皮筋特性。
        document.addEventListener('touchstart', function(e){
            e.stopPropagation();
            e.preventDefault();
        }, false);
    }
    */
    (function(libs){
        if(!query.act){
            query.act="index";
        }
        var url=cp.baseUrl()+query.act.replace(/>/g,"/")+".js";
        mb.ajax.require.async({
            url:cp.topUrl()+"index.js",
            notice:function(notice){
                notice({
                    init:function(){
                        mb.ajax.require.async({
                            url:url,
                            notice:function(success){
                                var obj=success();
                                var root=document.getElementById("root");
                                var body=root.parentElement;
                                
                                var rpd;
                                if(mb.DOM.isMobile()){
                                    rpd=0;
                                }else{
                                    rpd=10;
                                }
                                root.style.padding=rpd+"px";
                                if(obj.getElement){
                                    //传统的jsdom
                                    var el=obj.getElement();
                                    window.onresize=function(){
                                        var _w=body.clientWidth-(rpd*2);
                                        var _h=body.clientHeight-(rpd*2);
                                        el.style.width=_w+'px';
                                        el.style.height=_h+'px';
                                        if(obj.height){
                                            obj.height(_h);
                                        }
                                        if(obj.width){
                                            obj.width(_w);
                                        }
                                    };
                                    root.appendChild(el);
                                    if(obj.init){
                                        obj.init();
                                    }
                                    window.onresize();
                                }else{
                                    root.appendChild(obj);
                                }
                                mb.log("加载完成");
                            }
                        });
                    }
                });
            }
        });
    })();
};
</script>
</head>
<body>
	<div id="root"></div>
</body>
</html>