<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
    <meta name="apple-mobile-web-app-capable" content="yes" /> <!-- safari强制全屏 -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>首页</title>
    <style type="text/css">
      html,body{
        margin: 0;
        border:none;
        padding: 0;
        overflow: hidden;
        width:100%;
        height: 100%;
        position: fixed;
      }
    </style>
    <script type="text/javascript">
      window.load_success=function(){

        function getHash(v,d){
          var search=""
          if(d){
            search=mb.util.urlFromDic(d)
            if(v.indexOf("?")<0){
              search="?"+search
            }
          }
          return mb.util.calAbsolutePath(window.location.hash,v)+search;
        }
        var cp={
          baseUrl:function(){
            return "."
          },
          go:function(v,d){
            window.location.hash=getHash(v,d)
          },
          replace:function(v,d){
            var hash=getHash(v,d)
            var url=window.location.origin+window.location.pathname;
            window.location.replace(url+hash);
          },
          back:function(i){
            history.go(i)
          },
          //原始的查询部分
          search:"",
          //原始查询的字典
          query:{},
          //页面对象
          object:null
        }
        mb.ajax.require.cp=cp
        mb.ajax.require.baseUrl=cp.baseUrl()
        function init(){
          var hash=mb.util.decodeURI(window.location.hash)
          if(hash[0]=="#"){
            var index=hash.indexOf("?")
            if(index>0){
              var act=hash.substr(1,index-1)
              var search=hash.substr(index)
            }else{
              var act=hash.substr(1)
              var search=""
            }
          }else{
            var act="index"
            var search=""
          }
          cp.search=search
          cp.query=mb.util.dicFromUrl(search)
          mb.ajax.require("./pages/"+act+".js",function(object){
            //销毁旧的
            if(cp.object){
              if(cp.object.destroy){
                cp.object.destroy()
              }
              mb.DOM.empty(document.body)
            }
            //追加新的
            document.body.appendChild(object.element)
            if(object.init){
              object.init()
            }
            cp.object=object
          })
        }
        mb.DOM.addEvent(window,"hashchange",init)
        init()
      }
    </script>
    <script src="../../lib/front-lib/lib.js"></script>
  </head>
  <body>
  </body>
</html>