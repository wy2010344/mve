æˆ‘éœ€è¦ä¸ºæˆ‘çš„mveæ¡†æ¶å†™ä¸€ä¸ªæ–‡æ¡£.
mveæ˜¯åŸºäºsignalæ¨¡å¼çš„å‰ç«¯æ¡†æ¶.
ä½ å¯ä»¥å‚è€ƒ:https://github.com/wy2010344/mve-vite-demo è¿™ä¸ªé¡¹ç›®,æˆ‘é‡Œé¢ç”¨mveå†™äº†å¾ˆå¤šä»£ç ,å®ƒåœ¨è¿™å°ç”µè„‘çš„è·¯å¾„æ˜¯ /Volumes/ç§»åŠ¨ç¡¬ç›˜/Users/wangyang/Documents/github/mve-vite-demo.
å®ƒä¾èµ–æˆ‘çš„å¤šä¸ªè‡ªç ”é¡¹ç›®:wy-helper,wy-dom-helper,mve-core,mve-helper,mve-dom,mve-dom-helper,ä½ ä¹Ÿå¯ä»¥å°è¯•ç€å»é˜…è¯»å®ƒä»¬çš„æºä»£ç .(/Volumes/ç§»åŠ¨ç¡¬ç›˜/Users/wangyang/Documents/github/wy-helper,/Volumes/ç§»åŠ¨ç¡¬ç›˜/Users/wangyang/Documents/github/mve)
å¸Œæœ›ä½ è¾“å‡ºçš„æ–‡æ¡£å¯¹äºaiå‹å¥½,ä»»ä½•æ–°aiå¯¹è¯é˜…è¯»åéƒ½èƒ½å†™å‡ºç†æƒ³çš„ä»£ç ,å¹¶èƒ½å®ç°å…¶å®ƒæ¡†æ¶ä»£ç (å¦‚vueã€reactã€svelteç­‰)å‘mveæ¡†æ¶çš„ä»£ç è¿ç§».(æ¯”å¦‚æˆ‘å°†æ¥ä¼šè¦åšä¸€ä¸ªtdesign-vueçš„ä»£ç è½¬åŒ–æˆæˆ‘çš„mveçš„ä»£ç ,æœ¬æ¬¡ä»»åŠ¡ä½ ä¸åš)
ä½ æœ‰ä¸æ‡‚çš„åœ°æ–¹å¯ä»¥é—®æˆ‘,ç†è§£åå¯ä»¥è¡¥å…¨æ–‡æ¡£ä¸æ¡ˆä¾‹.
ä½ å¯ä»¥è¾¹å­¦ä¹ è¾¹è¯¢é—®,è¿˜å¯ä»¥ç»™å‡ºå»ºè®®,æ¯”å¦‚ä½ è§‰å¾—æœ‰ä»€ä¹ˆæ›´å¥½çš„è§£å†³æ–¹æ¡ˆ.
æ–‡æ¡£å¤ªé•¿å¯ä»¥æ‹†åˆ†.
æ¯”å¦‚ä½ å¯ä»¥åœ¨ /Volumes/ç§»åŠ¨ç¡¬ç›˜/Users/wangyang/Documents/github/mve/demo/src/pages ä¸‹å†™å‡ ä¸ªdemo,æˆ‘è¾¹çœ‹è¾¹è¡¥å……ä½ çš„ç†è§£.
æ–‡æ¡£è¾“å‡ºä½ç½®:/Volumes/ç§»åŠ¨ç¡¬ç›˜/Users/wangyang/Documents/github/mve/docs é¿å¼€è¦†ç›–askAi.txtè¿™ä¸ªæ–‡æ¡£,
demoè¾“å‡ºä½ç½®:/Volumes/ç§»åŠ¨ç¡¬ç›˜/Users/wangyang/Documents/github/mve/demo/src/pages 


æˆ‘çœ‹äº†ä¸‹ä½ ç”Ÿæˆçš„ä»£ç ä¸æ–‡æ¡£,ç›®å‰æœ‰è¿™æ ·å‡ ä¸ªé—®é¢˜.
1. /Volumes/ç§»åŠ¨ç¡¬ç›˜/Users/wangyang/Documents/github/mve è¿™ç§æ˜¯ç»å¯¹è·¯å¾„,å°±æ˜¯å½“å‰è¿™ä¸ªmveç›®å½•.ä½ ä¸èƒ½è®¿é—®å®ƒä¸Šå±‚githubç›®å½•ä¸‹çš„ç›¸é‚»é¡¹ç›®å—?å¦‚æœä¸èƒ½è¯·å‘ŠçŸ¥,å¦‚æœèƒ½è¯·è°ƒæ•´ä¸€ä¸‹.
2. åœ¨domä¸Šæ¡¥æ¥,ç›®å‰åšäº†ä¸‰ç§å°è¯•,ä½ å¯ä»¥ä»”ç»†é˜…è¯»mve/domä¸‹çš„æºç åŠåˆ†æç±»å‹,ä¸»è¦ç±»ä¼¼äº
```

//æœ€åŸå§‹çš„,æœ€æ¥è¿‘åŸå§‹xmlå®šä¹‰çš„
dom.div({
  className:'xxx',
  style:{
    color:...
  }
}).render(()=>{

})

//å°†åŒ…æ‹¬style,children,data-attrç­‰æ‰“å¹³åœ¨å‚æ•°objecté‡Œçš„
fdom.div({
  className:...,
  s_color:...,
  children(){
    ...
  }
})
//å‚è€ƒåªå—ä¸€ä¸ªå‡½æ•°ä¾èµ–çš„attrs.
mdom.div({
  attrs(m){
    m.className=...
    m.s_color=...
  },
  children(){
    ...
  }
})
```
3. ä½ å¯ä»¥é˜…è¯»wy-helperä¸­signal.tsçš„æºç ,æœ‰ä¸€ä¸ªé‡è¦çš„trackSignal,åŠå…¶åœ¨mveæ¡†æ¶ä¸­çš„hookTrackSignal,ç±»ä¼¼äºvueä¸­çš„watch.ä»¥åŠaddEffect,ç±»ä¼¼reactçš„useEffect,å°†äº‹ä»¶é¢„è®¾åˆ°æ›´æ–°åç»Ÿä¸€çš„æ‰§è¡Œ.

å¦‚æœä½ ä¸ç†è§£,è¯·å‘é—®.
å¦‚æœç†è§£äº†,è¯·é€ä¸ªè§£å†³,æ›´æ–°ä»£ç ä¸æ–‡æ¡£


å…ˆå¤„ç†ç¬¬ä¸€ä¸ªé—®é¢˜,ä½ å†™åˆ°äº†ç›®å½• /Volumes/ç§»åŠ¨ç¡¬ç›˜/Users/wangyang/Documents/github/mve/Volumes/ç§»åŠ¨ç¡¬ç›˜/Users/wangyang/Documents/github/mve/ è€Œä¸æ˜¯  /Volumes/ç§»åŠ¨ç¡¬ç›˜/Users/wangyang/Documents/github/mve/ è¯·è°ƒæ•´ä¸€ä¸‹,æˆ‘ä»¬å†ç»§ç»­å·¥ä½œ

æ„Ÿè§‰æœ‰ç‚¹æ··ä¹±,æœ‰ç‚¹ä¸æˆä½“ç³»,æœ‰äº›åœ°æ–¹ä»ç„¶æ˜¯é”™è¯¯çš„ä¸”ä¸è¯´äº†.ä½ å°±æ²¡æœ‰ç–‘é—®å—?æ¯”å¦‚å¼‚æ­¥è¯·æ±‚æ•°æ®æ€ä¹ˆåš?åŠ¨ç”»æ€ä¹ˆåš?

æœ‰ä¸ªhookPromiseSignalçš„å‡½æ•°,ä¸€èˆ¬ç”¨äºè§‚å¯Ÿä¾èµ–è§¦å‘å¼‚æ­¥å›è°ƒçš„çŠ¶æ€æ›´æ–°,ä½ å¯ä»¥ä¸€å±‚ä¸€å±‚çš„æŸ¥é˜…å®ƒçš„ä»£ç ,äº†è§£å®ƒçš„åº•å±‚å®ç°,é¡ºä¾¿åŠ æ·±å¯¹å…¶å®ƒå·¥å…·å‡½æ•°çš„ç†è§£.å¦‚æœè§‰å¾—ä»¥å‰çš„ç†è§£æœ‰è¯¯,è®°å¾—æ›´æ–°æ–‡æ¡£

éœ€è¦ä½ æ•´ç†ä¸€ä¸‹ä½ åˆ›å»ºçš„æ‰€æœ‰æ–‡æ¡£,éœ€è¦æ›´ç®€æ´å¹²ç»ƒ,æœ€å¥½ç›¸äº’æ˜ è¯,ç»Ÿä¸€è§„åˆ’,æ•´ä½“ä¸€è‡´,å¹¶ä¿®å¤ä¸€äº›çœ‹åˆ°çš„é€»è¾‘ä¸Šå‡ºé”™çš„åœ°æ–¹.(ä¸æ˜¯è¦ä½ 1ã€2ã€3ã€4è¿™æ ·ä¸æ–­å¢åŠ åœ°åˆ›å»ºæ–‡æ¡£,è€Œæ˜¯è¦åœ¨ä¸€ç§æ•´ä½“è§„åˆ’çš„æ€»åˆ†ç»“æ„ä¸‹,å„æœ‰åˆ†å·¥)



å¸Œæœ›ä½ å†ä»”ç»†é˜…è¯»
/Volumes/ç§»åŠ¨ç¡¬ç›˜/Users/wangyang/Documents/github/mve-vite-demo
å¦‚æœä¸å¤Ÿ,è¿˜æœ‰
/Volumes/ç§»åŠ¨ç¡¬ç›˜/Users/wangyang/Documents/github/verify-app
/Volumes/ç§»åŠ¨ç¡¬ç›˜/Users/wangyang/Documents/github/chat-note/client
æ¥å®Œå–„ä½ å¯¹è¿™å¥—å†™æ³•çš„ç†è§£
å¦‚æœæœ‰ç–‘é—®,å†å…ˆè¯¢é—®æˆ‘,ä¸è¦è‡ªè¡Œç¼–é€ .
è¿˜æœ‰demoæˆ‘å¯åŠ¨èµ·æ¥äº†.æˆ‘åŠ äº†tailwindcssä½ å¯ä»¥ç¾åŒ–,æˆ‘ä¼šå°†è¿è¡Œæ—¶é”™è¯¯æŠ¥å‘Šç»™ä½ .
åŸºäºä¸Šä¼˜åŒ–æ–‡æ¡£ä¸demo.

createTreeRoute æ˜¯éå† import.meta.glob('./pages/**') çš„åŠ è½½,ç”ŸæˆåŸºäºç›®å½•çš„è·¯ç”±,å…¶ä¸­,ä¸€èˆ¬index.tsæ˜¯é¡µé¢,layout.tsæ˜¯å¸ƒå±€,default.tsæ˜¯æœªæ‰¾åˆ°æ—¶å±•ç¤ºçš„é¡µé¢.daisy-mobile-helperæ˜¯æˆ‘å¸¸ç”¨çš„ç§»åŠ¨ç«¯å°è£…,ä¸»è¦æ˜¯é›†æˆtailwindcssä¸daisy-ui,è¿˜æœ‰history.renderPop()æ˜¯æœ‰ä¸€ä¸ªç®€å•çš„å…¨å±€å¼¹çª—å°è£….IconContextä¸»è¦æ˜¯ä¸ºmve-iconsè¿™ä¸ªå›¾æ ‡æä¾›å…¨å±€çš„é»˜è®¤è§£é‡Š.é¡¹ç›®ä¸­å¤§é‡ä½¿ç”¨äº† Tailwind CSS å’Œ DaisyUI,åªæ˜¯æˆ‘çš„ä¸€ç§åå¥½.ç›®å‰å¹¶æœªçœ‹åˆ°é”™è¯¯.ä½ éœ€è¦å¤šè¯»ä»£ç ,ä¸è¦æµ…å°è¾„æ­¢.è¿˜æ˜¯æˆ‘éœ€è¦é€šè¿‡åˆ«çš„ä»€ä¹ˆæ–¹å¼å°†ä»£ç æä¾›ç»™ä½ ,è¿™æ ·è¯»å¾—å¤ªæ…¢?



å‡å°‘é¢å‘å¯¹è±¡çš„ä½¿ç”¨,é¢å‘å¯¹è±¡ä¸æ˜¯å¿…è¦çš„,ä¿¡å·å¯ä»¥å……å½“ä¸­å¿ƒçŠ¶æ€,æ‰€ä»¥å¹¶ä¸éœ€è¦ç‰¹åˆ«å»åˆ¶ä½œ.è¿˜æœ‰ç»å¸¸å‡ºç°çš„ä¸€ä¸ªé”™,åœ¨fdom.xx({...})é‡Œ,æ²¡æœ‰styleå±æ€§,æ‰€æœ‰styleä¸‹çš„å±æ€§,éƒ½åœ¨attrè¿™ä¸€å±‚,å¦‚style.color,ç°åœ¨å…¶å®æ˜¯s_color.


æˆ‘è®¤ä¸ºmveçš„æ ¸å¿ƒä»ç„¶åœ¨wy-helperçš„signal.tsè¿™ä¸ªæ¨¡å—é‡Œ,ä¸»è¦æ˜¯ä¿¡å·(createSignal)ä¸å¯¹ä¿¡å·çš„è§‚å¯Ÿ(trackSignal),ä»¥åŠä»ä¿¡å·åˆ°è§‚å¯Ÿä¸­é—´å‡å°‘è®¡ç®—çš„ä¼˜åŒ–(memo),å½“ç„¶æœ‰ä¸€ä¸ªç±»ä¼¼reactåœ¨æ‰€æœ‰æ›´æ–°å®Œæˆåçš„äº‹ä»¶å›è°ƒ(addEffect).å› ä¸ºæ˜¯æ‰¹é‡æ›´æ–°,å¯ä»¥æ˜¾å¼è°ƒç”¨ç«‹å³æ‰§è¡Œè¿™ä¸ªæ‰¹é‡æ›´æ–°(batchSignalEnd)
ç„¶åæ˜¯åŸºäºä¿¡å·çš„å£°æ˜å¼guiæ¡†æ¶,ä¸»è¦æ˜¯mve-coreé‡Œå®ç°åŸºç¡€,é‡è¦çš„æ˜¯stateHolder,ä¸»è¦å°±æ˜¯é”€æ¯çš„å›è°ƒé’©å­(æ­¤åå¤šç”¨hookDestroyæ·»åŠ è¿›å»)ä¸context.å¯¹äºæ¡ä»¶æ¸²æŸ“ä¸åˆ—è¡¨æ¸²æŸ“,å°è£…äº†ä¸€ä¸ªåŸºç¡€çš„renderForEach,æ­¤åçš„renderArray/renderIf/renderOne/renderArayKey...ç­‰,éƒ½æ˜¯åŸºäºè¿™ä¸ªrenderForEachçš„å°è£….renderForEachä¸‹æ¯ä¸€ä¸ªå­é¡¹åœ¨åå°æœ‰ä¸€ä¸ªè‡ªå·±çš„stateHolder.
ç„¶åä¸»è¦æ˜¯mveåœ¨domä¸Šçš„æ¡¥æ¥å®ç°,åœ¨mve-domè¿™ä¸ªæ¨¡å—é‡Œ.åˆ©ç”¨tsçš„è”åˆç±»å‹,ä¸€ä¸ªå±æ€§å­—æ®µå¯ä»¥æ˜¯å€¼,ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªgetå€¼çš„å‡½æ•°,å¦‚æœæ˜¯ä¸€ä¸ªè¿”å›å€¼çš„å‡½æ•°,é‚£ä¹ˆå°±æ˜¯åˆ©ç”¨trackSignalè§‚å¯Ÿè¿™ä¸ªå‡½æ•°é‡Œé¢çš„ä¿¡å·,æ¥é€šçŸ¥å˜æ›´è¿™ä¸ªå±æ€§.å‡ºäºä¸åŒçš„ä½¿ç”¨åœºæ™¯,æœ‰3å¥—å°è£…,å³dom.xx/svg.xx,fdom.xx/svg.xx,mdom.xx/asvg.xx.è¿˜æœ‰å¯¹é’ˆå¯¹textNodeçš„renderText,renderTextContentå‡½æ•°.
mve-helperæ˜¯mve-coreçš„ä¸€äº›å¤–å›´å¸®åŠ©å‡½æ•°,mve-dom-helperæ˜¯è‡ªå·±å°è£…çš„ä¸€äº›å¸¸ç”¨çš„dom helperå‡½æ•°.
åŸºäºè¿™é¡¹åŸºç¡€è®¤è¯†,å†æ€»ç»“ä¸€ä¸‹.æˆ–è€…æœ‰ä»€ä¹ˆç–‘é—®å’Œå»ºè®®,å¯ä»¥å…ˆåé¦ˆä¸€ä¸‹.



æˆ‘éœ€è¦ä¸ºæˆ‘çš„mveæ¡†æ¶å†™ä¸€ä¸ªæ–‡æ¡£.
å®ƒä¾èµ–æˆ‘çš„å¤šä¸ªè‡ªç ”é¡¹ç›®:wy-helper,wy-dom-helper,mve-core,mve-helper,mve-dom,mve-dom-helper,ä½ ä¹Ÿå¯ä»¥å°è¯•ç€å»é˜…è¯»å®ƒä»¬çš„æºä»£ç .(/Volumes/ç§»åŠ¨ç¡¬ç›˜/Users/wangyang/Documents/github/wy-helper,/Volumes/ç§»åŠ¨ç¡¬ç›˜/Users/wangyang/Documents/github/mve)
mveçš„æ ¸å¿ƒåœ¨wy-helperçš„signal.tsè¿™ä¸ªæ¨¡å—é‡Œ,ä¸»è¦æ˜¯ä¿¡å·(createSignal)ä¸å¯¹ä¿¡å·çš„è§‚å¯Ÿ(trackSignal),ä»¥åŠä»ä¿¡å·åˆ°è§‚å¯Ÿä¸­é—´å‡å°‘è®¡ç®—çš„ä¼˜åŒ–(memo),å½“ç„¶æœ‰ä¸€ä¸ªç±»ä¼¼reactåœ¨æ‰€æœ‰æ›´æ–°å®Œæˆåçš„äº‹ä»¶å›è°ƒ(addEffect).å› ä¸ºæ˜¯æ‰¹é‡æ›´æ–°,å¯ä»¥æ˜¾å¼è°ƒç”¨ç«‹å³æ‰§è¡Œè¿™ä¸ªæ‰¹é‡æ›´æ–°(batchSignalEnd)
ç„¶åæ˜¯åŸºäºä¿¡å·çš„å£°æ˜å¼guiæ¡†æ¶,ä¸»è¦æ˜¯mve-coreé‡Œå®ç°åŸºç¡€,é‡è¦çš„æ˜¯stateHolder,ä¸»è¦å°±æ˜¯é”€æ¯çš„å›è°ƒé’©å­(æ­¤åå¤šç”¨hookDestroyæ·»åŠ è¿›å»)ä¸context.å¯¹äºæ¡ä»¶æ¸²æŸ“ä¸åˆ—è¡¨æ¸²æŸ“,å°è£…äº†ä¸€ä¸ªåŸºç¡€çš„renderForEach,æ­¤åçš„renderArray/renderIf/renderOne/renderArayKey...ç­‰,éƒ½æ˜¯åŸºäºè¿™ä¸ªrenderForEachçš„å°è£….renderForEachä¸‹æ¯ä¸€ä¸ªå­é¡¹åœ¨åå°æœ‰ä¸€ä¸ªè‡ªå·±çš„stateHolder.
ç„¶åä¸»è¦æ˜¯mveåœ¨domä¸Šçš„æ¡¥æ¥å®ç°,åœ¨mve-domè¿™ä¸ªæ¨¡å—é‡Œ.åˆ©ç”¨tsçš„è”åˆç±»å‹,ä¸€ä¸ªå±æ€§å­—æ®µå¯ä»¥æ˜¯å€¼,ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªgetå€¼çš„å‡½æ•°,å¦‚æœæ˜¯ä¸€ä¸ªè¿”å›å€¼çš„å‡½æ•°,é‚£ä¹ˆå°±æ˜¯åˆ©ç”¨trackSignalè§‚å¯Ÿè¿™ä¸ªå‡½æ•°é‡Œé¢çš„ä¿¡å·,æ¥é€šçŸ¥å˜æ›´è¿™ä¸ªå±æ€§.å‡ºäºä¸åŒçš„ä½¿ç”¨åœºæ™¯,æœ‰3å¥—å°è£…,å³dom.xx/svg.xx,fdom.xx/svg.xx,mdom.xx/asvg.xx.è¿˜æœ‰å¯¹é’ˆå¯¹textNodeçš„renderText,renderTextContentå‡½æ•°.
mve-helperæ˜¯mve-coreçš„ä¸€äº›å¤–å›´å¸®åŠ©å‡½æ•°,mve-dom-helperæ˜¯è‡ªå·±å°è£…çš„ä¸€äº›å¸¸ç”¨çš„dom helperå‡½æ•°.
ä½ å¯ä»¥è¾¹å­¦ä¹ è¾¹è¯¢é—®,è¿˜å¯ä»¥ç»™å‡ºå»ºè®®,æ¯”å¦‚ä½ è§‰å¾—æœ‰ä»€ä¹ˆæ›´å¥½çš„è§£å†³æ–¹æ¡ˆ.
å¸Œæœ›ä½ åˆ›å»ºçš„æ‰€æœ‰æ–‡æ¡£,ç®€æ´å¹²ç»ƒ,æœ€å¥½ç›¸äº’æ˜ è¯,ç»Ÿä¸€è§„åˆ’,æ•´ä½“ä¸€è‡´.
å¸Œæœ›ä½ å†ä»”ç»†é˜…è¯»
/Volumes/ç§»åŠ¨ç¡¬ç›˜/Users/wangyang/Documents/github/mve-vite-demo
å¦‚æœä¸å¤Ÿ,è¿˜æœ‰
/Volumes/ç§»åŠ¨ç¡¬ç›˜/Users/wangyang/Documents/github/verify-app
/Volumes/ç§»åŠ¨ç¡¬ç›˜/Users/wangyang/Documents/github/chat-note/client
ç†è§£å®ƒçš„ç”¨æ³•.
æ–‡æ¡£è¾“å‡ºä½ç½®:/Volumes/ç§»åŠ¨ç¡¬ç›˜/Users/wangyang/Documents/github/mve/tecent
demoè¾“å‡ºä½ç½®:/Volumes/ç§»åŠ¨ç¡¬ç›˜/Users/wangyang/Documents/github/mve/demo/src/tecent 

renderForEachæœ‰ç­¾å```function renderForEach<T, K = T, O = void>(
  forEach: (
    callback: (
      key: K,
      value: T
    ) => GetValue<O>
  ) => void,
  creater: Creater<T, K, O>,
  arg: RenderForEachArg = emptyObject
)```å³å›è°ƒé‡Œä¼šä¼ æœ‰key,ä½ æ˜¯å¦éœ€è¦å…ˆé˜…è¯»ä»£ç å†ä½œåé—®?è€Œä¸”ä¸€èˆ¬ä½¿ç”¨çš„æ˜¯mve-helperä¸­å°è£…çš„renderArrayKeyã€renderIfã€renderOneã€renderOneKey.
å› ä¸ºç›´æ¥ç”¨tsçš„è¯­æ³•æ¥åˆ¶ä½œçš„DSL,æœ¬èº«å°±æ˜¯ç±»å‹å®‰å…¨çš„,ä¸éœ€è¦tsxç”»è›‡æ·»è¶³.æ¯”å¦‚:
```
fdom.div({
  className:'abc'
})
fdom.div({
  className(){
    return signalA()?'abc':'bcd'
  }
})
``
å…¶å®ƒè¡¥å……:
memoç±»ä¼¼vueçš„computed,æ¯”å¦‚ä¸¤ä¸ªmemo:a,b.båªä¾èµ–a,è€Œaçš„æ¯æ¬¡è¿”å›éƒ½ç›¸åŒ,åˆ™bçš„è®¡ç®—ä¸ä¼šå‘ç”Ÿ.
addEffectå¯ä»¥æ”¾åœ¨ä»»ä½•å‡½æ•°å¤„,åŒ…æ‹¬memoå†…,trackSignalçš„å›è°ƒå†….åœ¨memoä¸trackSignaléƒ½ä¸èƒ½ç›´æ¥æ›´æ–°signal,ä½†åœ¨addEffectçš„å›è°ƒé‡Œå¯ä»¥.æ‰€ä»¥ä¹Ÿå¯ä»¥æ¨¡æ‹Ÿreactçš„usEffect.addEffectçš„ç¬¬äºŒä¸ªå‚æ•°levelç±»ä¼¼zIndex,åŒä¸€æ‰¹æ¬¡ä¸­,levelè¶Šå¤§è¶Šå¾€åæ‰§è¡Œ.
trackSignalç±»ä¼¼vueä¸­çš„watchEffectä¹‹ç±»çš„api,
```
trackSignal(getA,function(a){

})
```
æ¯”å¦‚ä¸Šé¢è¿™ä¸ªåˆé‡‘trackSignalä¸­getAéƒ¨åˆ†ä¸ä¼šè‡ªåŠ¨memo,ç¬¬äºŒéƒ¨åˆ†åªæœ‰aå‘ç”Ÿå˜åŒ–æ—¶æ‰æ‰§è¡Œ.
åœ¨æ¡†æ¶é‡Œä¸€èˆ¬ä¹Ÿä¸ç›´æ¥ç”¨trackSignal,è€Œæ˜¯ç”¨hookTrackSignal,å°†é”€æ¯ç»‘å®šåˆ°stateHolderä¸Š.å³ä½¿å…¨å±€ä»»æ„åœ°æ–¹,ä¹Ÿå¯ä»¥å†™æˆ:
```
runGlobalHolder(function(){
  hookTrackSignal(()=>xxx,vv=>{

  })
})
```
ä½ å†çœ‹çœ‹æ–‡æ¡£æ˜¯å¦æœ‰æ›´å¥½çš„è¡¥å……?æˆ–è€…æ›´å¥½çš„æ•´ç†.è®°ä½æˆ‘ä»¬çš„åˆè¡·:æ–‡æ¡£æ˜¯å¸Œæœ›æ–¹ä¾¿è¿ç§»vue/reactçš„ä»£ç ,ä¸»è¦æ˜¯tdesign-vue-mobileçš„ä»£ç 

ä¸éœ€è¦ä½ å¤ªæ·±å…¥åŸç†,åªéœ€è¦åˆ«çš„aié˜…è¯»æ–‡æ¡£åèƒ½å†™ä»£ç ,æˆ–èƒ½ä»vue/reactçš„ä»£ç è½¬åŒ–æˆè¿™ä¸ªmveçš„ä»£ç .
éœ€è¦ä½ è¾“å…¥æ–‡æ¡£ä¸demo
æ–‡æ¡£è¾“å‡ºä½ç½®:/Volumes/ç§»åŠ¨ç¡¬ç›˜/Users/wangyang/Documents/github/mve/tecent
demoè¾“å‡ºä½ç½®:/Volumes/ç§»åŠ¨ç¡¬ç›˜/Users/wangyang/Documents/github/mve/demo/src/tecent 


ä½ çš„æ–‡æ¡£åˆå¼€å§‹åœ¨å˜å¤š,æ•´ç†ä¸€ä¸‹,ä¸€äº›ä¸å¿…è¦çš„åˆ é™¤.æ¯”å¦‚æ€ä¹ˆæœ‰ä¸ªcore-concepts-corrected.md,åˆæœ‰ä¸ªcore-concepts.md?
æˆ‘çœ‹åˆ°ä½ åœ¨FEEDBACK_AND_QUESTIONS.mdä¸­çš„é—®é¢˜,
renderForEachä¸€èˆ¬ä¸ç›´æ¥è°ƒç”¨,é€šå¸¸è°ƒç”¨å®ƒçš„å°è£…renderArrayKeyã€renderIfã€renderOneç­‰.
æ¯”å¦‚renderArrayKey,å‚æ•°1æ˜¯è·å¾—æ•°ç»„çš„ä¾èµ–å‡½æ•°,å‚æ•°2æ˜¯ä»æ¯ä¸ªæ•°ç»„å…ƒç´ ä¸­å–å¾—æ ‡è®°å”¯ä¸€æ€§çš„key,å‚æ•°3åˆ™æ˜¯å›è°ƒæ¸²æŸ“çš„å‡½æ•°(getItem,getIndex,key)=>void.
å½“æ•°ç»„å˜åŒ–æ—¶,å¦‚æœæ–°æ•°ç»„ä¸­æŸitemæ¶ˆå¤±,åˆ™å¯¹åº”keyçš„stateHolderæ¶ˆå¤±,å¦‚æœæœ‰æ–°å¢,åˆ™æ–°å»ºä¸€ä¸ªstateHolder.å¦‚æœä»ç„¶å­˜åœ¨,åˆ™ä¿æŒ,æ²¡ä»€ä¹ˆç¥ç§˜çš„,å›è°ƒå‡½æ•°é‡ŒgetItem,getIndexåŠ¨æ€è·å¾—æœ€æ–°çš„itemå†…å®¹ä¸åºå·.
trackSignalçš„ä¾èµ–æ”¶é›†,å—vueå¯å‘,ä»£ç ä¹Ÿä¸å¤æ‚ç›¸ä¿¡ä½ èƒ½ç†è§£.å®ƒæœ¬æ¥æ€§èƒ½å·²ç»æœ€ä¼˜,ä¸€èˆ¬è®¡ç®—é“¾è·¯ä¸Šçš„ä¼˜åŒ–,ä½¿ç”¨memo.
å¦,trackSignalçš„å›è°ƒé‡Œ,åªæœ‰newValueæ²¡æœ‰oldValue,memoçš„å›è°ƒå‚æ•°
interface MemoGet<T> {
  (old: undefined, inited: false): T,
  (old: T, inited: true): T
},å‚æ•°1æ˜¯æ—§å€¼,å‚æ•°2æ˜¯æ˜¯å¦ä¸æ˜¯ç¬¬ä¸€æ¬¡æ‰§è¡Œ.
dom.xxæ˜¯æ¯”è¾ƒç¬¦åˆdomçš„ç»“æ„,å¦‚
```
dom.div({
  style:{
    color:'red',
    background(){
      return a()?bg1():bg2()
    }
  }
}).render(function(){
  renderTextContent('abc')
  dom.span().renderText`abc`
  dom.div().renderTextContent(()=>{
    return `${value()}abc`
  })
})
```
fdom.xx,æ˜¯å¸Œæœ›ç®€åŒ–dom.xxçš„api,æ¯”å¦‚
```
fdom.div({
  className:'abc',
  s_color:'red',
  s_background(){
      return a()?bg1():bg2()
  },
  children(){
    renderText`abc`
    fdom.span({
      childrenType:"text",
      children:`abc`
    })
    fdom.div({
      childrenType:'html',
      children(){
        return `<svg>${svgStr()}</svg>`
      }
    })
  }
})
```
mdom.xxæ˜¯åº”å¯¹åŒä¸€å…ƒç´ ä¸Šè¿‡å¤šå±æ€§ä¾èµ–ç›¸åŒçš„ä¿¡å·,å‡å°‘å»ºç«‹trackSignal,å¹¶ä½¿ä»£ç ç®€æ´,å¦‚
```
mdom({
  attrs(m){
    if(a()){
      m.s_color='red'
      m.s_background='green'
    }else{
      m.s_color='blue'
      m.s_background='yellow'
    }
    m.className='abc'
  },
  children(){
    mdom({
      childrenType:'text',
      children(){
        return `abc${dy()}`
      }
    })
  }
})
```
å¼€å‘å·¥å…·,æš‚æ—¶ä¸è€ƒè™‘
é”™è¯¯è¾¹ç•Œ,å¯¹è¿™ä¸ªæ¡†æ¶ä¸é€‚ç”¨
å¼‚æ­¥çŠ¶æ€,ä¸éœ€è¦åŸç”Ÿæ”¯æŒ.æœ‰ä¸ªhookPromiseSignal,å¦‚
```
const {get,loading,reduceSet}=hookPromiseSignal(()=>{
  const a=getSignalA()
  const b=getSignalB()
  return function(){
    return fetchRemote(a,b)
  }
})

```
å³getSignalA()ä¸getSignalB()å‘ç”Ÿå˜åŒ–,éƒ½ä¼šè§¦å‘fetchRemoteçš„é‡æ–°æ‰§è¡Œ.
è¿™ä¸ªgetå°±æ˜¯è¿œç¨‹è¿”å›çš„ä¿¡å·,loadingæ˜¯æ˜¯å¦æ­£åœ¨åŠ è½½ä¸­,reduceSet,æ˜¯å¦‚æœæ˜¯æˆåŠŸçš„,å¯ä»¥ä¿®æ”¹ä¿¡å·çš„å†…å®¹
å¦‚æœä½ æœ‰ç†è§£äº†,æ›´æ–°å¥½äº†æ–‡æ¡£ä¹‹å,å¯ä»¥åˆ é™¤ç›¸åº”çš„é—®é¢˜



å…¶å®ƒçœ‹åˆ°é—®é¢˜è¡¥å……
1.createSignalåˆ›å»ºçš„æ˜¯åŸå­ä¿¡å·,ä¸æ˜¯åƒvueçš„refåµŒå¥—åˆ›å»ºä¿¡å·,æˆ–è€…è¯´åƒshallowRef.æ‰€ä»¥æœ‰æ—¶å€™å¯ä»¥è€ƒè™‘æ‰‹åŠ¨æŒ‰éœ€åˆ›å»ºåµŒå¥—çš„ä¿¡å·æ¥ä¼˜åŒ–,å¦‚
```
const a=createSignal({
  value:createSignal(9),
  name:createSignal('8')
})
///åœ¨å›è°ƒä¸­
a.get().value.set(8)
a.get().value.name.set('ddd')
```
ä¸”createSignalåˆ›å»ºå‡ºæ¥çš„åªæ˜¯ä¸€ä¸ªobject,å¯ä»¥éšæ„è§£åŒ…æˆgetã€set,ä¸æ˜¯å¯¹è±¡,ä¸è€ƒè™‘ç»‘å®šthis.

2.contextä¸€èˆ¬ä¼ é€’çš„æ˜¯ä¿¡å·ä¸äº‹ä»¶,å³getSignal,changeSignalè¿™ç§
```
//æä¾›çš„æ—¶å€™
ThemeContext.provide(theme.get);
//æ¶ˆè€—çš„æ—¶å€™
const getTheme=ThemeContext.consume()
fdom.div({
  s_color(){
    return getTheme()=='light'?'black':'white'
  }
})

```
3.children()å›è°ƒä¸­ä¸€èˆ¬ä¸è·å¾—ä¿¡å·å†…å®¹,ä¿¡å·å†…å®¹éœ€è¦åœ¨æœ€ç»ˆè§‚å¯Ÿå±æ€§èŠ‚ç‚¹ä¸Šå±•å¼€
```
//é”™è¯¯çš„å†™æ³•
fdom.li({
  children() {
    const todo = getItem();
    const index = getIndex();
    
    fdom.span({
      childrenType: "text",
      children: `${index + 1}. ${todo.text}`
    });
    
  }
})
//æ­£ç¡®çš„å†™æ³•,childrenTypeä¸ºtextæˆ–htmlæ—¶,childrenå˜æˆgetè¿™ä¸ªtextä¸htmlçš„å†…å®¹
fdom.li({
  children() {
    fdom.span({
      childrenType: "text",
      children(){
        const todo = getItem();
        const index = getIndex();
        return `${index + 1}. ${todo.text}`
      }
    });
    
  }
})
```

è¿˜æœ‰å…¶å®ƒä¸€äº›é”™è¯¯:
```
//é”™è¯¯:
dom.div().className("container").onClick(handler).append(
  dom.p().text("å†…å®¹")
);
//æ­£ç¡®
dom.div({
  className:'container',
  onClick(){
    //
  }
}).render(function(){
  dom.p().renderTextContent("å†…å®¹")
})
```
åŸºäºä»¥ä¸Š,å†çœ‹çœ‹ä¿®æ­£ä¸ä¼˜åŒ–

æ–‡æ¡£è¶Šæ¥è¶Šå¤š,è€ƒè™‘åˆå¹¶ä¸€äº›é‡å¤çš„å†…å®¹.memoä¸€èˆ¬æ˜¯å‡å°‘é‡å¤çš„é‡è®¡ç®—,å‚è€ƒæºç å¯ä»¥çœ‹åˆ°èƒŒåä¾èµ–äº†Map,å¦‚æœè®¡ç®—é‡è¿œå°‘äºå®ƒçš„å®ç°,å¯ä»¥è€ƒè™‘ä¸ä½¿ç”¨,åœ¨fdomä¸­,é™¤äº†style.xxxè½¬åŒ–æˆs_xxx,è¿˜æœ‰data-attrXXXè½¬åŒ–æˆdata_attrXXX,cssäº¦æ˜¯--varcssxxå˜æˆcss_varcssxxx,aria-xxxå˜æˆaria_xxx.mdomä¸­attrs(m){}ä¸­m,å±æ€§ä¸ä¹‹ç±»ä¼¼.mdomä¸fdomçš„childrenã€childrenTypeæ˜¯ä¸€æ ·çš„.

addEffectçš„è°ƒç”¨å…¶å®ç±»ä¼¼äºnextTick,åªæ˜¯å®ƒæœ‰levelå±‚çº§,é»˜è®¤level 0.level -1,-2æ˜¯domæ›´æ–°çš„å‰¯ä½œç”¨,æ‰€ä»¥ä¸€èˆ¬leveléƒ½éœ€è¦å¤§äº-1.hookTrackSignalçš„æ—¶å€™,å¸¸å¸¸åœ¨ç¬¬äºŒä¸ªå›è°ƒå‚æ•°é‡ŒæŒ‰éœ€addEffect.



æˆ‘çœ‹åˆ°ä½ å†™çš„ä»£ç ä¸­è‡³å°‘æœ‰è¿™ä¸¤ä¸ªé”™è¯¯:
1.hookTrackSignalå…¶å®åœ¨å®é™…ä¸­å¾ˆå°‘ç”¨,ä¸»è¦å·²ç»ç”¨äºdom/fdomç­‰çš„å±æ€§ç»‘å®š,è¿˜æœ‰hookPromiseSignalé‡Œä¹Ÿæœ‰,åç»­å¯èƒ½jså—æ§åŠ¨ç”»å¯èƒ½éœ€è¦.æ‰€ä»¥hookPromiseSignalè¿”å›ä¸­çš„get,å¯ä»¥é—´æ¥ç”¨äºç»‘å®šåˆ°å±æ€§ä¸Š,è€Œä¸éœ€è¦é€šè¿‡hookTrackSignalåŒæ­¥åˆ°æŸä¸ªsignalä¸Š.æ¯”å¦‚```
const {get}=hookPromiseSignal(....)
fdom({
  s_color(){
    const n=get()
    if(n?.type=='success'){
      return n.value.color
    }
    return ''
  }
})
```
2.contextçš„ç”¨æ³•ä½¿ç”¨é”™è¯¯,ä½ ä½¿ç”¨äº†reactå¼çš„ç”¨æ³•,å…¶å®
```
XXContext.provide('a')
funA()//å†…éƒ¨ä½¿ç”¨XXContext.consume()è·å¾—çš„æ˜¯'a'
XXContext.provide('b')
funB()//å†…éƒ¨ä½¿ç”¨XXContext.consume()è·å¾—çš„æ˜¯'b'
```
æ ¹æ®ä»¥ä¸Šå†ä¼˜åŒ–,çœ‹çœ‹æ˜¯å¦æ–‡æ¡£ä¹Ÿéœ€è¦è¡¥å…….


æˆ‘è¿˜çœ‹åˆ°ä¸€ä¸ªé”™è¯¯,å°±æ˜¯ä¾èµ–countçš„å˜åŒ–ç”ŸæˆtrackingLogçš„è®°å½•,è™½ç„¶æ­£å¸¸ä½¿ç”¨ä¸­ä¸ä¼šå‡ºç°è¿™ç§éœ€æ±‚(ä¸€èˆ¬æ˜¯memoåˆ°signal)
addEffectçš„å›è°ƒä¸æ˜¯ç»Ÿè®¡ä¾èµ–è‡ªåŠ¨æ‰§è¡Œ
éœ€è¦å†™æˆ
```
hookTrackSignal(count.get,function(c){
  const log = `è®¡æ•°å˜åŒ–: ${currentCount} (${new Date().toLocaleTimeString()})`;
  addEffect(()=>{
    trackingLog.set([log, ...trackingLog.get().slice(0, 4)]);
  })
  if (currentCount === 10) {
    alert('ğŸ‰ æ­å–œï¼è®¡æ•°è¾¾åˆ° 10');
  }
})
```
æ‰ä¼šçœŸæ­£æœ‰æ•ˆ.